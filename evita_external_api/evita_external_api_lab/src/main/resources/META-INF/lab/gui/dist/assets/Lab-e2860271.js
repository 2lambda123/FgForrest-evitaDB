/*
 *
 *                         _ _        ____  ____
 *               _____   _(_) |_ __ _|  _ \| __ )
 *              / _ \ \ / / | __/ _` | | | |  _ \
 *             |  __/\ V /| | || (_| | |_| | |_) |
 *              \___| \_/ |_|\__\__,_|____/|____/
 *
 *   Copyright (c) 2024
 *
 *   Licensed under the Business Source License, Version 1.1 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *   https://github.com/FgForrest/evitaDB/blob/main/LICENSE
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 */

import{p as Z,h as I,s as B,i as L,j as ot,k as N,l as ge,n as _e,q as lt,b as oe,t as Me,v as st,x as be,y as ee,d as le,V as Ee,e as r,z as G,A as it,B as rt,C as ut,D as ct,m as ye,E as dt,F as vt,G as Ne,a as mt,u as pt,c as ft,H as ht,I as Ae,J as gt,K as _t,L as bt,M as yt,N as wt,O as St,P as kt,Q as Vt,R as Tt,T as Rt,S as D,U as E,W as ve,o as f,f as k,w as u,X as w,Y as Oe,Z as Lt,$ as b,a0 as H,a1 as we,a2 as se,a3 as ie,_ as Q,a4 as X,a5 as x,a6 as He,a7 as Se,a8 as Ct,a9 as M,aa as me,ab as We,ac as J,ad as pe,ae as It,af as Ge,ag as qt,ah as j,ai as K,aj as ze,ak as q,al as F,am as re,an as Ye,ao as $t,ap as fe,aq as he,ar as Ut,as as Fe,at as Qe,au as ke,av as te,aw as ae,ax as Ve,ay as Te,az as W,aA as Re,aB as xt,aC as Et,aD as At,aE as Bt,aF as Dt,aG as de,aH as Be,aI as Pt,aJ as Mt,aK as Nt,aL as Ot,aM as Ht,aN as Wt,aO as Gt,aP as zt,aQ as Yt,aR as Ft,aS as Qt,aT as jt,aU as Xt,aV as Zt,aW as Jt,aX as Kt}from"./index-c59cfe4e.js";import{a as je,u as Xe,b as ea}from"./layout-16d109c0.js";const ta=Z({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function aa(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:i}=l;let o=0;const a=I(null),t=B(0),s=B(0),c=B(0),g=B(!1),m=B(!1),n=L(()=>Number(e.scrollThreshold)),p=L(()=>ot((n.value-t.value)/n.value||0)),S=()=>{const h=a.value;!h||i&&!i.value||(o=t.value,t.value="window"in h?h.pageYOffset:h.scrollTop,m.value=t.value<o,c.value=Math.abs(t.value-n.value))};return N(m,()=>{s.value=s.value||t.value}),N(g,()=>{s.value=0}),ge(()=>{N(()=>e.scrollTarget,h=>{var U;const T=h?document.querySelector(h):window;T&&T!==a.value&&((U=a.value)==null||U.removeEventListener("scroll",S),a.value=T,a.value.addEventListener("scroll",S,{passive:!0}))},{immediate:!0})}),_e(()=>{var h;(h=a.value)==null||h.removeEventListener("scroll",S)}),i&&N(i,S,{immediate:!0}),{scrollThreshold:n,currentScroll:t,currentThreshold:c,isScrollActive:g,scrollRatio:p,isScrollingUp:m,savedScroll:s}}const na=Z({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...lt(),...je(),...ta(),height:{type:[Number,String],default:64}},"VAppBar"),oa=oe()({name:"VAppBar",props:na(),emits:{"update:modelValue":e=>!0},setup(e,l){let{slots:i}=l;const o=I(),a=Me(e,"modelValue"),t=L(()=>{var d;const v=new Set(((d=e.scrollBehavior)==null?void 0:d.split(" "))??[]);return{hide:v.has("hide"),inverted:v.has("inverted"),collapse:v.has("collapse"),elevate:v.has("elevate"),fadeImage:v.has("fade-image")}}),s=L(()=>{const v=t.value;return v.hide||v.inverted||v.collapse||v.elevate||v.fadeImage||!a.value}),{currentScroll:c,scrollThreshold:g,isScrollingUp:m,scrollRatio:n}=aa(e,{canScroll:s}),p=L(()=>e.collapse||t.value.collapse&&(t.value.inverted?n.value>0:n.value===0)),S=L(()=>e.flat||t.value.elevate&&(t.value.inverted?c.value>0:c.value===0)),h=L(()=>t.value.fadeImage?t.value.inverted?1-n.value:n.value:void 0),T=L(()=>{var y,V;if(t.value.hide&&t.value.inverted)return 0;const v=((y=o.value)==null?void 0:y.contentHeight)??0,d=((V=o.value)==null?void 0:V.extensionHeight)??0;return v+d});st(L(()=>!!e.scrollBehavior),()=>{it(()=>{t.value.hide?t.value.inverted?a.value=c.value>g.value:a.value=m.value||c.value<g.value:a.value=!0})});const{ssrBootStyles:U}=be(),{layoutItemStyles:P}=Xe({id:e.name,order:L(()=>parseInt(e.order,10)),position:ee(e,"location"),layoutSize:T,elementSize:B(void 0),active:a,absolute:ee(e,"absolute")});return le(()=>{const[v]=Ee.filterProps(e);return r(Ee,G({ref:o,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...P.value,"--v-toolbar-image-opacity":h.value,height:void 0,...U.value},e.style]},v,{collapse:p.value,flat:S.value}),i)}),{}}}),la="/lab/logo/evitalab-logo-mini.png?raw=true",sa="/lab/documentation.svg",ia="/lab/discord.svg",ra="/lab/github.svg";function ua(e){let{rootEl:l,isSticky:i,layoutItemStyles:o}=e;const a=B(!1),t=B(0),s=L(()=>{const m=typeof a.value=="boolean"?"top":a.value;return[i.value?{top:"auto",bottom:"auto",height:void 0}:void 0,a.value?{[m]:rt(t.value)}:{top:o.value.top}]});ge(()=>{N(i,m=>{m?window.addEventListener("scroll",g,{passive:!0}):window.removeEventListener("scroll",g)},{immediate:!0})}),_e(()=>{window.removeEventListener("scroll",g)});let c=0;function g(){const m=c>window.scrollY?"up":"down",n=l.value.getBoundingClientRect(),p=parseFloat(o.value.top??0),S=window.scrollY-Math.max(0,t.value-p),h=n.height+Math.max(t.value,p)-window.scrollY-window.innerHeight,T=parseFloat(getComputedStyle(l.value).getPropertyValue("--v-body-scroll-y"))||0;n.height<window.innerHeight-p?(a.value="top",t.value=p):m==="up"&&a.value==="bottom"||m==="down"&&a.value==="top"?(t.value=window.scrollY+n.top-T,a.value=!0):m==="down"&&h<=0?(t.value=0,a.value="bottom"):m==="up"&&S<=0&&(T?a.value!=="top"&&(t.value=-S+T+p,a.value="top"):(t.value=n.top+S,a.value="top")),c=window.scrollY}return{isStuck:a,stickyStyles:s}}const ca=100,da=20;function De(e){const l=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*l}function Pe(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let l=0;for(let i=e.length-1;i>0;i--){if(e[i].t===e[i-1].t)continue;const o=De(l),a=(e[i].d-e[i-1].d)/(e[i].t-e[i-1].t);l+=(a-o)*Math.abs(a),i===e.length-1&&(l*=.5)}return De(l)*1e3}function va(){const e={};function l(a){Array.from(a.changedTouches).forEach(t=>{(e[t.identifier]??(e[t.identifier]=new ut(da))).push([a.timeStamp,t])})}function i(a){Array.from(a.changedTouches).forEach(t=>{delete e[t.identifier]})}function o(a){var m;const t=(m=e[a])==null?void 0:m.values().reverse();if(!t)throw new Error(`No samples for touch id ${a}`);const s=t[0],c=[],g=[];for(const n of t){if(s[0]-n[0]>ca)break;c.push({t:n[0],d:n[1].clientX}),g.push({t:n[0],d:n[1].clientY})}return{x:Pe(c),y:Pe(g),get direction(){const{x:n,y:p}=this,[S,h]=[Math.abs(n),Math.abs(p)];return S>h&&n>=0?"right":S>h&&n<=0?"left":h>S&&p>=0?"down":h>S&&p<=0?"up":ma()}}}return{addMovement:l,endTouch:i,getVelocity:o}}function ma(){throw new Error}function pa(e){let{isActive:l,isTemporary:i,width:o,touchless:a,position:t}=e;ge(()=>{window.addEventListener("touchstart",v,{passive:!0}),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("touchend",y,{passive:!0})}),_e(()=>{window.removeEventListener("touchstart",v),window.removeEventListener("touchmove",d),window.removeEventListener("touchend",y)});const s=L(()=>["left","right"].includes(t.value)),{addMovement:c,endTouch:g,getVelocity:m}=va();let n=!1;const p=B(!1),S=B(0),h=B(0);let T;function U(_,R){return(t.value==="left"?_:t.value==="right"?document.documentElement.clientWidth-_:t.value==="top"?_:t.value==="bottom"?document.documentElement.clientHeight-_:Y())-(R?o.value:0)}function P(_){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const C=t.value==="left"?(_-h.value)/o.value:t.value==="right"?(document.documentElement.clientWidth-_-h.value)/o.value:t.value==="top"?(_-h.value)/o.value:t.value==="bottom"?(document.documentElement.clientHeight-_-h.value)/o.value:Y();return R?Math.max(0,Math.min(1,C)):C}function v(_){if(a.value)return;const R=_.changedTouches[0].clientX,C=_.changedTouches[0].clientY,$=25,O=t.value==="left"?R<$:t.value==="right"?R>document.documentElement.clientWidth-$:t.value==="top"?C<$:t.value==="bottom"?C>document.documentElement.clientHeight-$:Y(),z=l.value&&(t.value==="left"?R<o.value:t.value==="right"?R>document.documentElement.clientWidth-o.value:t.value==="top"?C<o.value:t.value==="bottom"?C>document.documentElement.clientHeight-o.value:Y());(O||z||l.value&&i.value)&&(n=!0,T=[R,C],h.value=U(s.value?R:C,l.value),S.value=P(s.value?R:C),g(_),c(_))}function d(_){const R=_.changedTouches[0].clientX,C=_.changedTouches[0].clientY;if(n){if(!_.cancelable){n=!1;return}const O=Math.abs(R-T[0]),z=Math.abs(C-T[1]);(s.value?O>z&&O>3:z>O&&z>3)?(p.value=!0,n=!1):(s.value?z:O)>3&&(n=!1)}if(!p.value)return;_.preventDefault(),c(_);const $=P(s.value?R:C,!1);S.value=Math.max(0,Math.min(1,$)),$>1?h.value=U(s.value?R:C,!0):$<0&&(h.value=U(s.value?R:C,!1))}function y(_){if(n=!1,!p.value)return;c(_),p.value=!1;const R=m(_.changedTouches[0].identifier),C=Math.abs(R.x),$=Math.abs(R.y);(s.value?C>$&&C>400:$>C&&$>3)?l.value=R.direction===({left:"right",right:"left",top:"down",bottom:"up"}[t.value]||Y()):l.value=S.value>.5}const V=L(()=>p.value?{transform:t.value==="left"?`translateX(calc(-100% + ${S.value*o.value}px))`:t.value==="right"?`translateX(calc(100% - ${S.value*o.value}px))`:t.value==="top"?`translateY(calc(-100% + ${S.value*o.value}px))`:t.value==="bottom"?`translateY(calc(100% - ${S.value*o.value}px))`:Y(),transition:"none"}:void 0);return{isDragging:p,dragProgress:S,dragStyles:V}}function Y(){throw new Error}const fa=["start","end","left","right","top","bottom"],ha=Z({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>fa.includes(e)},sticky:Boolean,...ct(),...ye(),...dt(),...je(),...vt(),...Ne({tag:"nav"}),...mt()},"VNavigationDrawer"),Ze=oe()({name:"VNavigationDrawer",props:ha(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,l){let{attrs:i,emit:o,slots:a}=l;const{isRtl:t}=pt(),{themeClasses:s}=ft(e),{borderClasses:c}=ht(e),{backgroundColorClasses:g,backgroundColorStyles:m}=Ae(ee(e,"color")),{elevationClasses:n}=gt(e),{mobile:p}=_t(),{roundedClasses:S}=bt(e),h=yt(),T=Me(e,"modelValue",null,A=>!!A),{ssrBootStyles:U}=be(),{scopeId:P}=wt(),v=I(),d=B(!1),y=L(()=>e.rail&&e.expandOnHover&&d.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),V=L(()=>St(e.location,t.value)),_=L(()=>!e.permanent&&(p.value||e.temporary)),R=L(()=>e.sticky&&!_.value&&V.value!=="bottom");e.expandOnHover&&e.rail!=null&&N(d,A=>o("update:rail",!A)),e.disableResizeWatcher||N(_,A=>!e.permanent&&Tt(()=>T.value=!A)),!e.disableRouteWatcher&&h&&N(h.currentRoute,()=>_.value&&(T.value=!1)),N(()=>e.permanent,A=>{A&&(T.value=!0)}),kt(()=>{e.modelValue!=null||_.value||(T.value=e.permanent||!p.value)});const{isDragging:C,dragProgress:$,dragStyles:O}=pa({isActive:T,isTemporary:_,width:y,touchless:ee(e,"touchless"),position:V}),z=L(()=>{const A=_.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):y.value;return C.value?A*$.value:A}),{layoutItemStyles:ce,layoutItemScrimStyles:Ke}=Xe({id:e.name,order:L(()=>parseInt(e.order,10)),position:V,layoutSize:z,elementSize:y,active:L(()=>T.value||C.value),disableTransitions:L(()=>C.value),absolute:L(()=>e.absolute||R.value&&typeof Ce.value!="string")}),{isStuck:Ce,stickyStyles:et}=ua({rootEl:v,isSticky:R,layoutItemStyles:ce}),Ie=Ae(L(()=>typeof e.scrim=="string"?e.scrim:null)),tt=L(()=>({...C.value?{opacity:$.value*.2,transition:"none"}:void 0,...Ke.value}));Vt({VList:{bgColor:"transparent"}});function at(){d.value=!0}function nt(){d.value=!1}return le(()=>{const A=a.image||e.image;return r(D,null,[r(e.tag,G({ref:v,onMouseenter:at,onMouseleave:nt,class:["v-navigation-drawer",`v-navigation-drawer--${V.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":d.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":_.value,"v-navigation-drawer--active":T.value,"v-navigation-drawer--sticky":R.value},s.value,g.value,c.value,n.value,S.value,e.class],style:[m.value,ce.value,O.value,U.value,et.value,e.style]},P,i),{default:()=>{var qe,$e,Ue,xe;return[A&&r("div",{key:"image",class:"v-navigation-drawer__img"},[a.image?(qe=a.image)==null?void 0:qe.call(a,{image:e.image}):r("img",{src:e.image,alt:""},null)]),a.prepend&&r("div",{class:"v-navigation-drawer__prepend"},[($e=a.prepend)==null?void 0:$e.call(a)]),r("div",{class:"v-navigation-drawer__content"},[(Ue=a.default)==null?void 0:Ue.call(a)]),a.append&&r("div",{class:"v-navigation-drawer__append"},[(xe=a.append)==null?void 0:xe.call(a)])]}}),r(Rt,{name:"fade-transition"},{default:()=>[_.value&&(C.value||T.value)&&!!e.scrim&&r("div",G({class:["v-navigation-drawer__scrim",Ie.backgroundColorClasses.value],style:[tt.value,Ie.backgroundColorStyles.value],onClick:()=>T.value=!1},P),null)]})])}),{isStuck:Ce}}}),Le=e=>(se("data-v-d5be678f"),e=e(),ie(),e),ga={class:"lab-logo"},_a={href:"https://github.com/lukashornych/evitalab",target:"_blank"},ba={class:"lab-nav-links"},ya={href:"https://evitadb.io/documentation",target:"_blank"},wa=Le(()=>w("img",{src:sa,alt:"evitaDB Documentation"},null,-1)),Sa={href:"https://discord.gg/VsNBWxgmSw",target:"_blank"},ka=Le(()=>w("img",{src:ia,alt:"Discord icon"},null,-1)),Va={href:"https://github.com/lukashornych/evitalab",target:"_blank"},Ta=Le(()=>w("img",{src:ra,alt:"GitHub icon"},null,-1)),Ra=E({__name:"LabPanel",props:{panel:{}},emits:["update:panel"],setup(e,{emit:l}){const i=I([{title:"Explorer",value:ve.Explorer,props:{prependIcon:"mdi-connection"}}]);function o(a){a.value?l("update:panel",a.id):l("update:panel",null)}return(a,t)=>(f(),k(Ze,{permanent:"",rail:"",class:"bg-primary-dark"},{prepend:u(()=>[w("div",ga,[w("a",_a,[r(Lt,{size:"30px"},{default:u(()=>[r(Oe,{alt:"evitaLab Logo",width:"30px",height:"30px",src:la})]),_:1})])])]),append:u(()=>[w("ul",ba,[w("li",null,[w("a",ya,[wa,r(H,{activator:"parent"},{default:u(()=>[b(" evitaDB documentation ")]),_:1})])]),w("li",null,[w("a",Sa,[ka,r(H,{activator:"parent"},{default:u(()=>[b(" Discord ")]),_:1})])]),w("li",null,[w("a",Va,[Ta,r(H,{activator:"parent"},{default:u(()=>[b(" Give us a ⭐️ on GitHub ")]),_:1})])])])]),default:u(()=>[r(we,{density:"compact",nav:"",items:i.value,selected:[a.panel],"onClick:select":o,class:"connection-explorer"},null,8,["items","selected"])]),_:1}))}});const La=Q(Ra,[["__scopeId","data-v-d5be678f"]]),Ca=e=>(se("data-v-1bfb882e"),e=e(),ie(),e),Ia={class:"tree-view-item__content"},qa={class:"text-truncate"},$a=Ca(()=>w("span",{class:"text-disabled"}," No items found ",-1)),Ua=E({__name:"VTreeViewItem",props:{openable:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},prependIcon:{},loading:{type:Boolean,default:!1},actions:{default:()=>[]}},emits:["click:action"],setup(e,{emit:l}){const i=e,o=I(!1);function a(){i.actions&&i.actions.length>0&&(o.value=!0)}return(t,s)=>(f(),k(We,{"prepend-icon":null,"append-icon":null,onContextmenu:me(a,["prevent"])},{default:u(()=>[w("div",Ia,[t.openable?(f(),k(X,{key:0},{default:u(()=>[b(x(t.isOpen?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:1})):(f(),k(X,{key:1})),t.loading?(f(),k(He,{key:2})):(f(),k(X,{key:3},{default:u(()=>[b(x(t.prependIcon),1)]),_:1})),w("span",qa,[Se(t.$slots,"default",{},()=>[$a],!0)]),t.actions&&t.actions.length>0?(f(),k(Ct,{key:4,"menu-items":t.actions,modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=c=>o.value=c)},{activator:u(({props:c})=>[r(X,G(c,{class:"text-gray-light"}),{default:u(()=>[b(" mdi-dots-vertical ")]),_:2},1040)]),default:u(()=>[r(we,{density:"compact",items:t.actions,"onClick:select":s[0]||(s[0]=c=>t.$emit("click:action",c.id))},null,8,["items"])]),_:1},8,["menu-items","modelValue"])):M("",!0)])]),_:3},8,["onContextmenu"]))}});const ne=Q(Ua,[["__scopeId","data-v-1bfb882e"]]),xa=E({__name:"LabExplorerCollectionItem",props:{entitySchema:{}},setup(e){const l=e,i=I([{value:"view-entities",title:"View entities",props:{prependIcon:"mdi-table"}},{value:"view-schema",title:"View schema",props:{prependIcon:"mdi-file-code"}}]),o=J(),a=pe("connection"),t=pe("catalogSchema");function s(){o.createTabRequest(It.createNew(a,t.value.name,l.entitySchema.name,void 0,!0))}function c(g){switch(g){case"view-entities":s();break;case"view-schema":o.createTabRequest(Ge.createNew(a,new qt(t.value.name,l.entitySchema.name)));break}}return(g,m)=>(f(),k(ne,{"prepend-icon":"mdi-list-box-outline",actions:i.value,onClick:s,"onClick:action":c,class:"text-gray-light text-sm-body-2"},{default:u(()=>[b(x(g.entitySchema.name)+" ",1),r(H,{activator:"parent"},{default:u(()=>[b(x(g.entitySchema.name),1)]),_:1})]),_:1},8,["actions"]))}}),Ea={},Aa=w("span",{class:"pl-8 text-disabled"}," No items found ",-1);function Ba(e,l){return f(),k(We,null,{default:u(()=>[Aa]),_:1})}const Je=Q(Ea,[["render",Ba]]),Da={key:0},Pa=E({__name:"LabExplorerCatalogItem",props:{catalog:{}},setup(e){const l=e,i=I([{value:"open-evitaql-console",title:"Open EvitaQL console",props:{prependIcon:"mdi-variable"}},{value:"open-graphql-data-api-console",title:"Open GraphQL Data API console",props:{prependIcon:"mdi-graphql"}},{value:"open-graphql-schema-api-console",title:"Open GraphQL Schema API console",props:{prependIcon:"mdi-graphql"}},{value:"view-schema",title:"View schema",props:{prependIcon:"mdi-file-code"}}]),o=j(),a=J(),t=K(),s=pe("connection"),c=I();ze("catalogSchema",c);const g=I(!1);async function m(){if(!(c.value!==void 0||l.catalog.corrupted)){g.value=!0;try{c.value=await o.getCatalogSchema(s,l.catalog.name)}catch(p){t.error(p)}g.value=!1}}function n(p){switch(p){case"open-evitaql-console":a.createTabRequest(Ut.createNew(s,l.catalog.name));break;case"open-graphql-data-api-console":a.createTabRequest(fe.createNew(s,l.catalog.name,he.Data));break;case"open-graphql-schema-api-console":a.createTabRequest(fe.createNew(s,l.catalog.name,he.Schema));break;case"view-schema":a.createTabRequest(Ge.createNew(s,new $t(l.catalog.name)));break}}return(p,S)=>(f(),k(Ye,{value:`${re(s).name}|${p.catalog.name}`},{activator:u(({isOpen:h,props:T})=>[p.catalog.corrupted?(f(),k(ne,G({key:1},T,{"prepend-icon":"mdi-menu",class:"text-red"}),{default:u(()=>[b(x(p.catalog.name)+" ",1),r(H,{activator:"parent"},{default:u(()=>[b(" This catalog couldn't be loaded because it's corrupted. ")]),_:1})]),_:2},1040)):(f(),k(ne,G({key:0},T,{openable:"","is-open":h,"prepend-icon":"mdi-menu",loading:g.value,actions:i.value,onClick:m,"onClick:action":n,class:"font-weight-bold"}),{default:u(()=>[b(x(p.catalog.name)+" ",1),r(H,{activator:"parent"},{default:u(()=>[b(x(p.catalog.name),1)]),_:1})]),_:2},1040,["is-open","loading","actions"]))]),default:u(()=>[!p.catalog.corrupted&&c.value!==void 0?(f(),q("div",Da,[Object.values(c.value.entitySchemas).length>0?(f(!0),q(D,{key:0},F(Object.values(c.value.entitySchemas),h=>(f(),k(xa,{key:h.name,"entity-schema":h},null,8,["entity-schema"]))),128)):(f(),k(Je,{key:1}))])):M("",!0)]),_:1},8,["value"]))}}),Ma=E({__name:"LabExplorerConnectionRemoveDialog",props:{modelValue:{type:Boolean},connection:{}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,o=j(),a=K();function t(){l("update:modelValue",!1)}function s(){try{o.removeConnection(i.connection.id)}catch(c){a.error(c);return}a.success("Connection removed."),l("update:modelValue",!1)}return(c,g)=>(f(),k(Re,{"model-value":c.modelValue,"max-width":"30rem","onUpdate:modelValue":g[0]||(g[0]=m=>c.$emit("update:modelValue",m))},{activator:u(({props:m})=>[Se(c.$slots,"activator",Fe(Qe(m)))]),default:u(()=>[r(ke,{class:"py-8 px-4"},{default:u(()=>[r(te,null,{default:u(()=>[b("Remove connection")]),_:1}),r(ae,{class:"mb-4"},{default:u(()=>[b(" Are you sure you want to remove the connection "),w("strong",null,x(c.connection.name),1),b("? ")]),_:1}),r(Ve,null,{default:u(()=>[r(Te),r(W,{onClick:t,variant:"tonal"},{default:u(()=>[b(" Cancel ")]),_:1}),r(W,{variant:"outlined","prepend-icon":"mdi-delete",onClick:s},{default:u(()=>[b(" Remove ")]),_:1})]),_:1})]),_:1})]),_:3},8,["model-value"]))}}),Na={key:0},Oa=E({__name:"LabExplorerConnectionItem",props:{connection:{}},setup(e){const l=e,i=J(),o=j(),a=K();ze("connection",xt(l.connection));const t=I([{value:"open-graphql-system-api-console",title:"Open GraphQL System API console",props:{prependIcon:"mdi-graphql"}}]);!o.isReadOnly()&&!l.connection.preconfigured&&t.value.push({value:"remove",title:"Remove connection",props:{prependIcon:"mdi-delete"}});const s=I(!1),c=I(),g=I(!1);async function m(){if(c.value===void 0){g.value=!0;try{c.value=await o.getCatalogs(l.connection)}catch(p){a.error(p)}g.value=!1}}function n(p,S){switch(p){case"open-graphql-system-api-console":i.createTabRequest(fe.createNew(l.connection,"system",he.System));break;case"edit":throw new Et(void 0,"Not implemented yet.");case"remove":s.value=!0;break}}return(p,S)=>(f(),k(Ye,{value:p.connection.name},{activator:u(({isOpen:h,props:T})=>[r(ne,G(T,{openable:"","is-open":h,"prepend-icon":"mdi-power-plug-outline",loading:g.value,actions:t.value,onClick:m,"onClick:action":n,class:"font-weight-bold"}),{default:u(()=>[b(x(p.connection.name)+" ",1),r(H,{activator:"parent"},{default:u(()=>[b(x(p.connection.name),1)]),_:1})]),_:2},1040,["is-open","loading","actions"])]),default:u(()=>[c.value!==void 0?(f(),q("div",Na,[c.value.length>0?(f(!0),q(D,{key:0},F(c.value,h=>(f(),k(Pa,{key:h.name,catalog:h},null,8,["catalog"]))),128)):(f(),k(Je,{key:1}))])):M("",!0),r(Ma,{modelValue:s.value,"onUpdate:modelValue":S[0]||(S[0]=h=>s.value=h),connection:p.connection},null,8,["modelValue","connection"])]),_:1},8,["value"]))}}),Ha=Z({...ye(),...At()},"VForm"),Wa=oe()({name:"VForm",props:Ha(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,l){let{slots:i,emit:o}=l;const a=Bt(e),t=I();function s(g){g.preventDefault(),a.reset()}function c(g){const m=g,n=a.validate();m.then=n.then.bind(n),m.catch=n.catch.bind(n),m.finally=n.finally.bind(n),o("submit",m),m.defaultPrevented||n.then(p=>{var h;let{valid:S}=p;S&&((h=t.value)==null||h.submit())}),m.preventDefault()}return le(()=>{var g;return r("form",{ref:t,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:s,onSubmit:c},[(g=i.default)==null?void 0:g.call(i,a)])}),Dt(a,t)}}),Ga=E({__name:"LabExplorerConnectionEditor",props:{modelValue:{type:Boolean},connection:{default:void 0}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,o=j(),a=K(),t=[v=>v?!0:"Name of connection is required.",v=>o.isConnectionExists(v)?"Connection with this name already exists.":!0],s=[v=>v?!0:"evitaLab API URL is required.",v=>{try{return new URL(v),!0}catch{return"evitaLab API URL is not a valid URL."}},async v=>await S()?(n.value.labApiUrlTested=1,!0):(n.value.labApiUrlTested=2,"evitaLab API URL is not reachable.")],c=[v=>v?!0:"GraphQL API URL is required.",v=>{try{return new URL(v),!0}catch{return"GraphQL API URL is not a valid URL."}},async v=>await h()?(n.value.gqlUrlTested=1,!0):(n.value.gqlUrlTested=2,"GraphQL API URL is not reachable.")],g=I(null),m=L(()=>i.connection?1:0),n=I({name:"",labApiUrl:"",labApiUrlTested:0,gqlUrl:"",gqlUrlTested:0});function p(v){switch(v){case 0:return null;case 1:return"mdi-check-circle-outline";case 2:return"mdi-close-circle-outline"}}async function S(){try{return(await Be.get(n.value.labApiUrl+"/system/liveness").json()).liveness||!1}catch{return!1}}async function h(){var v;try{const d=await Be.post(n.value.gqlUrl+"/system",{headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
                    {
                        liveness
                    }
                `})}).json();return((v=d==null?void 0:d.data)==null?void 0:v.liveness)||!1}catch{return!1}}async function T(){let v=!0;return await S()?n.value.labApiUrlTested=1:(v=!1,n.value.labApiUrlTested=2),await h()?n.value.gqlUrlTested=1:(v=!1,n.value.gqlUrlTested=2),v?a.success("Successfully connected."):a.error("Connection test failed."),v}function U(){g.value.reset(),n.value={name:"",labApiUrl:"",labApiUrlTested:0,gqlUrl:"",gqlUrlTested:0},l("update:modelValue",!1)}async function P(){const{valid:v}=await g.value.validate();if(v){try{o.addConnection(new Pt(void 0,n.value.name,!1,n.value.labApiUrl,"https://localhost:5555/rest",n.value.gqlUrl))}catch(d){a.error(d);return}g.value.reset(),l("update:modelValue",!1)}}return(v,d)=>(f(),k(Re,{"model-value":v.modelValue,"onUpdate:modelValue":d[3]||(d[3]=y=>v.$emit("update:modelValue",y)),persistent:"","max-width":"36rem"},{activator:u(({props:y})=>[Se(v.$slots,"activator",Fe(Qe(y)))]),default:u(()=>[r(ke,{class:"py-8 px-4"},{default:u(()=>[m.value===0?(f(),k(te,{key:0},{default:u(()=>[b("Add connection")]),_:1})):M("",!0),m.value===1?(f(),k(te,{key:1},{default:u(()=>[b("Edit connection")]),_:1})):M("",!0),r(ae,null,{default:u(()=>[r(Wa,{ref_key:"form",ref:g,"validate-on":"submit"},{default:u(()=>[r(de,{modelValue:n.value.name,"onUpdate:modelValue":d[0]||(d[0]=y=>n.value.name=y),label:"Connection name",placeholder:"evitaDB",variant:"solo-filled",rules:t,required:""},null,8,["modelValue"]),r(de,{modelValue:n.value.labApiUrl,"onUpdate:modelValue":d[1]||(d[1]=y=>n.value.labApiUrl=y),label:"evitaLab API URL",placeholder:"https://{evitadb-server}:5555/lab/api",variant:"solo-filled",required:"",rules:s,"append-inner-icon":p(n.value.labApiUrlTested)},null,8,["modelValue","append-inner-icon"]),r(de,{modelValue:n.value.gqlUrl,"onUpdate:modelValue":d[2]||(d[2]=y=>n.value.gqlUrl=y),label:"GraphQL API URL",placeholder:"https://{evitadb-server}:5555/gql",variant:"solo-filled",required:"",rules:c,"append-inner-icon":p(n.value.gqlUrlTested)},null,8,["modelValue","append-inner-icon"])]),_:1},512)]),_:1}),r(Ve,{class:"px-6"},{default:u(()=>[r(W,{variant:"plain","prepend-icon":"mdi-connection",onClick:T},{default:u(()=>[b(" Test connection ")]),_:1}),r(Te),r(W,{variant:"tonal",onClick:U},{default:u(()=>[b(" Cancel ")]),_:1}),r(W,{variant:"outlined","prepend-icon":"mdi-content-save",onClick:P,class:"ml-4"},{default:u(()=>[b(" Save ")]),_:1})]),_:1})]),_:1})]),_:3},8,["model-value"]))}}),za={key:0,class:"pa-2"},Ya=E({__name:"LabExplorer",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const i=j(),o=I(!1),a=L(()=>i.getConnections());return(t,s)=>(f(),k(Ze,{permanent:"","model-value":t.modelValue,"onUpdate:modelValue":s[2]||(s[2]=c=>t.$emit("update:modelValue",c)),class:"bg-primary"},{append:u(()=>[re(i).isReadOnly()?M("",!0):(f(),q("div",za,[r(Ga,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=c=>o.value=c)},{activator:u(({props:c})=>[r(W,G({"prepend-icon":"mdi-plus",block:"",variant:"outlined"},c,{onClick:s[0]||(s[0]=g=>o.value=!0)}),{default:u(()=>[b(" Add connection ")]),_:2},1040)]),_:1},8,["modelValue"])]))]),default:u(()=>[r(we,{density:"compact",nav:""},{default:u(()=>[r(Mt,{class:"text-gray-light text-sm-body-2 font-weight-medium"},{default:u(()=>[b("Connections Explorer")]),_:1}),(f(!0),q(D,null,F(a.value,c=>(f(),k(Oa,{key:c.name,connection:c},null,8,["connection"]))),128))]),_:1})]),_:1},8,["model-value"]))}}),Fa=e=>(se("data-v-13c41550"),e=e(),ie(),e),Qa={class:"loading-screen"},ja={class:"loading-screen-info"},Xa=Fa(()=>w("span",null,"Loading, please wait ...",-1)),Za=E({__name:"LabEditorTabLoadingScreen",setup(e){return(l,i)=>(f(),q("div",Qa,[w("div",ja,[r(He,{size:48}),Xa])]))}});const Ja=Q(Za,[["__scopeId","data-v-13c41550"]]),Ka=E({__name:"LabEditorTabWindow",props:{component:{},componentProps:{}},emits:["dataUpdate"],setup(e,{emit:l}){const i=I(!1);return(o,a)=>(f(),q(D,null,[(f(),k(Wt,null,[Nt((f(),k(Ht(o.component),G(o.componentProps,{onReady:a[0]||(a[0]=t=>i.value=!0),onDataUpdate:a[1]||(a[1]=t=>l("dataUpdate",t))}),null,16)),[[Ot,i.value]])],1024)),i.value?M("",!0):(f(),k(Ja,{key:0}))],64))}});function en(e,l){return e.length<=l?e:e.substring(0,l-3)+"..."}const tn="/lab/logo/evitalab-logo-representative.svg",ue=e=>(se("data-v-93f8896e"),e=e(),ie(),e),an={class:"editor-welcome-screen"},nn={class:"editor-welcome-screen-hero"},on={class:"editor-welcome-screen-hero__header"},ln={class:"editor-welcome-screen-hero__title"},sn=ue(()=>w("h1",{class:"font-weight-bold mb-2",style:{"font-size":"4.375rem"}},"evitaLab",-1)),rn={class:"text-white",style:{"font-size":"1rem"}},un=ue(()=>w("a",{class:"text-primary-lightest text-body-2",href:"https://github.com/lukashornych/evitalab/releases",target:"_blank"},"(changelog)",-1)),cn=ue(()=>w("p",{class:"text-gray-light",style:{"font-size":"1rem"}},"evitaDB web client",-1)),dn={class:"editor-welcome-screen-blog"},vn=["href"],mn={class:"editor-welcome-screen-blog-img__wrap"},pn=["src","alt"],fn={class:"editor-welcome-screen-blog-item__title"},hn={class:"editor-welcome-screen-blog-item__perex"},gn=ue(()=>w("span",{class:"editor-welcome-screen-blog-item__btn"},"Read",-1)),_n=Gt('<span class="editor-welcome-screen-hr" data-v-93f8896e> </span><ul class="editor-welcome-screen-hero__links" data-v-93f8896e><li data-v-93f8896e>Check out the <a href="https://evitadb.io/documentation" target="_blank" data-v-93f8896e> evitaDB documentation</a></li><li data-v-93f8896e>Give us a ⭐ on <a href="https://github.com/lukashornych/evitalab/" target="_blank" data-v-93f8896e> GitHub</a></li><li data-v-93f8896e>Reach out to us on <a href="https://discord.gg/VsNBWxgmSw" target="_blank" data-v-93f8896e> Discord</a></li><li data-v-93f8896e><a href="https://github.com/lukashornych/evitalab/issues" target="_blank" data-v-93f8896e> Submit an issue</a></li></ul>',2),bn=E({__name:"LabEditorWelcomeScreen",setup(e){const l=j(),i=L(()=>{const a="v2024.1.0";return a.length===0?"?":a.substring(1)}),o=I([]);return l.getBlogPosts().then(a=>{o.value=a}),(a,t)=>(f(),q("div",an,[w("div",nn,[w("header",on,[r(Oe,{width:"240",height:"240","max-width":"240","max-height":"240",alt:"evitaLab Logo",src:tn,class:"evitalab-logo"}),w("div",ln,[sn,w("p",rn,[b(x(i.value)+" ",1),un]),cn])]),w("div",dn,[(f(!0),q(D,null,F(o.value,s=>(f(),q("a",{key:s.url,href:s.url,target:"_blank"},[w("span",mn,[w("img",{class:"Blog_BlogMotive__72hVr",height:"160",width:"480",src:s.thumbnailUrl,alt:`Image - ${s.title}`},null,8,pn)]),w("span",fn,x(s.title),1),w("span",hn,[r(zt,{source:s.perex},null,8,["source"])]),gn],8,vn))),128))]),_n])]))}});const yn=Q(bn,[["__scopeId","data-v-93f8896e"]]),wn=w("em",null,"open a new tab",-1),Sn=w("em",null,"not",-1),kn=w("em",null,"discarded",-1),Vn=w("em",null,"open a new tab",-1),Tn=w("em",null,"discarded",-1),Rn=w("em",null,"Be careful!",-1),Ln=E({__name:"LabEditorTabSharedDialog",props:{tabRequest:{}},emits:["resolve"],setup(e,{emit:l}){const i=e,o=J();function a(){console.log(i.tabRequest),o.createTabRequest(i.tabRequest),l("resolve")}function t(){l("resolve")}return(s,c)=>(f(),k(Re,{"model-value":!0,"max-width":"36rem","onUpdate:modelValue":t},{default:u(()=>[r(ke,{class:"py-8 px-4"},{default:u(()=>[r(te,null,{default:u(()=>[b("Shared tab found")]),_:1}),r(ae,null,{default:u(()=>[s.tabRequest.initialData!=null?(f(),q(D,{key:0},[b(" The URL contains an embedded query from an unknown source. Do you want to open it? If you accept, evitaLab will "),wn,b(" with the query, but will "),Sn,b(" execute it automatically. You can still decide if you want to execute it. If you reject, the query in the URL will be "),kn,b(". ")],64)):(f(),q(D,{key:1},[b(" The URL contains an embedded shared tab from an unknown source. Do you want to open it? If you accept it, evitaLab will "),Vn,b(" with the query. If you reject it, it will be "),Tn,b(". ")],64))]),_:1}),s.tabRequest.initialData!=null?(f(),k(ae,{key:0},{default:u(()=>[r(Yt,{icon:"mdi-alert-outline",type:"warning"},{default:u(()=>[Rn,b(" The query in the URL may contain potentially malicious code. ")]),_:1})]),_:1})):M("",!0),r(Ve,{class:"px-6"},{default:u(()=>[r(Te),r(W,{variant:"tonal",onClick:t},{default:u(()=>[b(" Reject ")]),_:1}),r(W,{variant:"outlined","prepend-icon":"mdi-check",onClick:a,class:"ml-4"},{default:u(()=>[b(" Accept ")]),_:1})]),_:1})]),_:1})]),_:1}))}});const Cn=Z({scrollable:Boolean,...ye(),...Ne({tag:"main"})},"VMain"),In=oe()({name:"VMain",props:Cn(),setup(e,l){let{slots:i}=l;const{mainStyles:o}=ea(),{ssrBootStyles:a}=be();return le(()=>r(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable},e.class],style:[o.value,a.value,e.style]},{default:()=>{var t,s;return[e.scrollable?r("div",{class:"v-main__scroller"},[(t=i.default)==null?void 0:t.call(i)]):(s=i.default)==null?void 0:s.call(i)]}})),{}}}),qn={key:1,style:{position:"relative"}},$n=E({__name:"LabEditor",setup(e){const l=Ft(),i=K(),o=J(),a=Qt(),t=jt(),s=I(!1),c=I(!1),g=I(),m=I(o.getTabRequests());N(m,()=>{const d=o.getNewTabRequest();d&&(n.value=d.id,o.markTabRequestAsVisited(d.id))},{deep:!0});const n=I();let p=new Map;function S(d,y){p.set(d,y)}function h(d){const y=m.value.length,V=m.value.findIndex(R=>R.id===n.value),_=m.value.findIndex(R=>R.id===d);o.destroyTabRequest(d),m.value.length===0?n.value=null:_===V&&_===y-1?n.value=m.value[_-1].id:_===V&&_<y-1&&(n.value=m.value[_].id)}async function T(){const d=l.query.demoSnippetRequest;if(d!=null)try{return await a.resolve(d)}catch(y){i.error(y)}}async function U(){const d=l.query.sharedTab;if(d!=null)try{return await t.resolve(d)}catch(y){i.error(y)}}function P(){try{let d=!1;const y=o.createTabRequestsForTabsFromLastSession();y!=null&&(p=y,d=!0),o.restoreTabHistory()&&(d=!0),d&&i.info("Your last session has been restored.")}catch(d){console.error(d),i.warning("Failed to fully restore your last session.")}}function v(){o.storeOpenedTabs(p),o.storeTabHistory()}return T().then(d=>(d!=null&&(s.value=!0,o.createTabRequest(d)),U())).then(d=>{d!=null&&(s.value=!0,g.value=d,c.value=!0),s.value||P()}),window.addEventListener("beforeunload",()=>{s.value||v()}),(d,y)=>(f(),q(D,null,[m.value.length>0?(f(),k(oa,{key:0,density:"compact",elevation:"0"},{default:u(()=>[r(Xt,{modelValue:n.value,"onUpdate:modelValue":y[0]||(y[0]=V=>n.value=V)},{default:u(()=>[(f(!0),q(D,null,F(m.value,V=>(f(),k(Jt,{key:V.id,value:V.id,"prepend-icon":V.icon,onMousedown:me(_=>h(V.id),["middle"]),class:"lab-tab"},{default:u(()=>[w("span",null,[b(x(re(en)(V.title,30))+" ",1),V.title.length>30?(f(),k(H,{key:0,activator:"parent"},{default:u(()=>[b(x(V.title),1)]),_:2},1024)):M("",!0)]),r(W,{icon:"",variant:"plain",density:"compact",class:"ml-3",onClick:me(_=>h(V.id),["stop"])},{default:u(()=>[r(X,null,{default:u(()=>[b("mdi-close")]),_:1}),r(H,{activator:"parent"},{default:u(()=>[b(" Close tab ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["value","prepend-icon","onMousedown"]))),128))]),_:1},8,["modelValue"])]),_:1})):M("",!0),r(In,{scrollable:!1,class:"lab-editor"},{default:u(()=>[m.value.length>0?(f(),k(Zt,{key:0,modelValue:n.value,"onUpdate:modelValue":y[1]||(y[1]=V=>n.value=V)},{default:u(()=>[(f(!0),q(D,null,F(m.value,V=>(f(),k(Kt,{key:V.id,value:V.id,transition:!1,"reverse-transition":!1,class:"window-item"},{default:u(()=>[r(Ka,{component:V.component,"component-props":V.componentProps(),onDataUpdate:_=>S(V.id,_)},null,8,["component","component-props","onDataUpdate"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(f(),q("div",qn,[r(yn)]))]),_:1}),g.value?(f(),k(Ln,{key:1,"tab-request":g.value,onResolve:y[2]||(y[2]=V=>g.value=void 0)},null,8,["tab-request"])):M("",!0)],64))}});const Un=Q($n,[["__scopeId","data-v-05163fab"]]),An=E({__name:"Lab",setup(e){const l=I(ve.Explorer);return(i,o)=>(f(),q(D,null,[r(La,{panel:l.value,"onUpdate:panel":o[0]||(o[0]=a=>l.value=a)},null,8,["panel"]),r(Ya,{"model-value":l.value===re(ve).Explorer},null,8,["model-value"]),r(Un)],64))}});export{An as default};
